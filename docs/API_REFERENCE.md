# LDIMS MCP æœåŠ¡ API å‚è€ƒ

> **å®Œæ•´çš„ MCP å·¥å…·å’Œèµ„æº API æ–‡æ¡£**

## ğŸ“‹ æ¦‚è¿°

LDIMS MCP æœåŠ¡æä¾›ç¬¦åˆ [Model Context Protocol](https://modelcontextprotocol.io/)
æ ‡å‡†çš„ API æ¥å£ï¼ŒåŒ…æ‹¬ï¼š

- **2 ä¸ª MCP å·¥å…· (Tools)**: å¯è¢« AI æ¨¡å‹è°ƒç”¨çš„å‡½æ•°
- **1 ä¸ª MCP èµ„æº (Resources)**: å¯è¢«å®¢æˆ·ç«¯è¯»å–çš„æ•°æ®æº

## ğŸ› ï¸ MCP å·¥å…· (Tools)

### 1. searchDocuments

åœ¨ LDIMS ç³»ç»Ÿä¸­æœç´¢æ–‡æ¡£ï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢å’Œè¯­ä¹‰æœç´¢ã€‚

#### åŸºæœ¬ä¿¡æ¯

- **å·¥å…·åç§°**: `searchDocuments`
- **æè¿°**: åœ¨LDIMSç³»ç»Ÿä¸­æœç´¢æ–‡æ¡£ã€‚æ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢å’Œè¯­ä¹‰æœç´¢ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿæ‰¾åˆ°ç›¸å…³æ–‡æ¡£ã€‚
- **ç±»å‹**: MCP Tool

#### è¾“å…¥å‚æ•°

```typescript
interface SearchDocumentsInput {
  query: string; // å¿…éœ€ï¼šæœç´¢æŸ¥è¯¢å­—ç¬¦ä¸²
  maxResults?: number; // å¯é€‰ï¼šè¿”å›ç»“æœçš„æœ€å¤§æ•°é‡
  filters?: SearchFilters; // å¯é€‰ï¼šæœç´¢è¿‡æ»¤æ¡ä»¶
}

interface SearchFilters {
  dateFrom?: string; // å¯é€‰ï¼šæ–‡æ¡£åˆ›å»º/ä¿®æ”¹èµ·å§‹æ—¥æœŸè¿‡æ»¤ï¼ˆISOæ ¼å¼ï¼‰
  dateTo?: string; // å¯é€‰ï¼šæ–‡æ¡£åˆ›å»º/ä¿®æ”¹ç»“æŸæ—¥æœŸè¿‡æ»¤ï¼ˆISOæ ¼å¼ï¼‰
  documentType?: string; // å¯é€‰ï¼šæŒ‰æ–‡æ¡£ç±»å‹/æ ¼å¼è¿‡æ»¤
  submitter?: string; // å¯é€‰ï¼šæŒ‰æ–‡æ¡£æäº¤äººè¿‡æ»¤
  searchMode?: "exact" | "semantic"; // å¯é€‰ï¼šæœç´¢æ¨¡å¼
}
```

#### å‚æ•°è¯¦ç»†è¯´æ˜

| å‚æ•°                   | ç±»å‹   | å¿…éœ€ | é»˜è®¤å€¼     | æè¿°                                                                 |
| ---------------------- | ------ | ---- | ---------- | -------------------------------------------------------------------- |
| `query`                | string | âœ…   | -          | è‡ªç„¶è¯­è¨€æˆ–å…³é”®è¯æœç´¢æŸ¥è¯¢ã€‚è¯·å…·ä½“æè¿°æ‚¨è¦æŸ¥æ‰¾çš„ä¿¡æ¯å†…å®¹ã€‚             |
| `maxResults`           | number | âŒ   | 5          | è¿”å›ç»“æœçš„æœ€å¤§æ•°é‡ã€‚èŒƒå›´ï¼š1-50ã€‚å¦‚éœ€æ›´å…¨é¢çš„ç»“æœå¯ä½¿ç”¨æ›´å¤§çš„æ•°å€¼ã€‚   |
| `filters.dateFrom`     | string | âŒ   | -          | æ–‡æ¡£åˆ›å»º/ä¿®æ”¹èµ·å§‹æ—¥æœŸè¿‡æ»¤ï¼ŒISO 8601 æ ¼å¼ï¼ˆå¦‚ï¼š2024-01-01T00:00:00Zï¼‰ |
| `filters.dateTo`       | string | âŒ   | -          | æ–‡æ¡£åˆ›å»º/ä¿®æ”¹ç»“æŸæ—¥æœŸè¿‡æ»¤ï¼ŒISO 8601 æ ¼å¼                             |
| `filters.documentType` | string | âŒ   | -          | æŒ‰æ–‡æ¡£ç±»å‹/æ ¼å¼è¿‡æ»¤ï¼ˆå¦‚ï¼šPDFã€Wordã€Excelï¼‰                          |
| `filters.submitter`    | string | âŒ   | -          | æŒ‰æ–‡æ¡£æäº¤äººè¿‡æ»¤                                                     |
| `filters.searchMode`   | enum   | âŒ   | "semantic" | æœç´¢æ¨¡å¼ï¼š'exact'ç²¾ç¡®åŒ¹é…ï¼Œ'semantic'è¯­ä¹‰åŒ¹é…                        |

#### ä½¿ç”¨ç¤ºä¾‹

**åŸºæœ¬æœç´¢**:

```json
{
  "name": "searchDocuments",
  "arguments": {
    "query": "æŠ€æœ¯è§„èŒƒæ–‡æ¡£"
  }
}
```

**é«˜çº§æœç´¢**:

```json
{
  "name": "searchDocuments",
  "arguments": {
    "query": "é¡¹ç›®ç®¡ç†ç›¸å…³çš„æ–‡æ¡£",
    "maxResults": 10,
    "filters": {
      "searchMode": "semantic",
      "documentType": "PDF",
      "dateFrom": "2024-01-01T00:00:00Z",
      "dateTo": "2024-12-31T23:59:59Z",
      "submitter": "å¼ ä¸‰"
    }
  }
}
```

### 2. get_document_file_content

è·å– LDIMS ç³»ç»Ÿä¸­æŒ‡å®šæ–‡æ¡£çš„åŸå§‹æ–‡ä»¶å†…å®¹ã€‚

#### åŸºæœ¬ä¿¡æ¯

- **å·¥å…·åç§°**: `get_document_file_content`
- **æè¿°**: è·å–LDIMSç³»ç»Ÿä¸­æŒ‡å®šæ–‡æ¡£çš„åŸå§‹æ–‡ä»¶å†…å®¹
- **ç±»å‹**: MCP Tool

#### è¾“å…¥å‚æ•°

```typescript
interface GetDocumentFileContentInput {
  file_id: string; // å¿…éœ€ï¼šæ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ç¬¦
}
```

#### å‚æ•°è¯¦ç»†è¯´æ˜

| å‚æ•°      | ç±»å‹   | å¿…éœ€ | æè¿°                                              |
| --------- | ------ | ---- | ------------------------------------------------- |
| `file_id` | string | âœ…   | æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨äºåœ¨ LDIMS ç³»ç»Ÿä¸­å®šä½ç‰¹å®šæ–‡æ¡£ |

#### ä½¿ç”¨ç¤ºä¾‹

```json
{
  "name": "get_document_file_content",
  "arguments": {
    "file_id": "doc-12345"
  }
}
```

## ğŸ“„ MCP èµ„æº (Resources)

### 1. ldims://docs/{document_id}/extracted_content

è·å– LDIMS ç³»ç»Ÿä¸­æ–‡æ¡£çš„æå–æ–‡æœ¬å†…å®¹ã€‚

#### åŸºæœ¬ä¿¡æ¯

- **èµ„æºåç§°**: `LDIMSæ–‡æ¡£æå–å†…å®¹`
- **URI æ¨¡å¼**: `ldims://docs/{document_id}/extracted_content`
- **æè¿°**: è·å–LDIMSç³»ç»Ÿä¸­æ–‡æ¡£çš„æå–æ–‡æœ¬å†…å®¹ï¼Œæ”¯æŒå„ç§æ–‡æ¡£æ ¼å¼çš„å†…å®¹æå–
- **MIME ç±»å‹**: `text/plain`

#### URI å‚æ•°

| å‚æ•°          | ç±»å‹   | å¿…éœ€ | æè¿°             |
| ------------- | ------ | ---- | ---------------- |
| `document_id` | string | âœ…   | æ–‡æ¡£çš„å”¯ä¸€æ ‡è¯†ç¬¦ |

#### ä½¿ç”¨ç¤ºä¾‹

**URI**: `ldims://docs/doc-12345/extracted_content`

## ğŸ”§ é€šç”¨é”™è¯¯å¤„ç†

### é”™è¯¯å“åº”æ ¼å¼

æ‰€æœ‰é”™è¯¯éƒ½éµå¾ªç»Ÿä¸€çš„å“åº”æ ¼å¼ï¼š

```typescript
interface McpErrorResponse {
  isError: true;
  errorCode: string;
  errorMessage: string;
  userMessage?: string;
  details?: Record<string, any>;
  timestamp: string;
}
```

### å¸¸è§é”™è¯¯ç 

| é”™è¯¯ç                | æè¿°         | å¸¸è§åŸå›                    |
| -------------------- | ------------ | -------------------------- |
| `INVALID_PARAMS`     | å‚æ•°éªŒè¯å¤±è´¥ | å‚æ•°ç±»å‹é”™è¯¯ã€ç¼ºå°‘å¿…éœ€å‚æ•° |
| `TOOL_NOT_FOUND`     | å·¥å…·ä¸å­˜åœ¨   | è°ƒç”¨äº†ä¸å­˜åœ¨çš„å·¥å…·åç§°     |
| `RESOURCE_NOT_FOUND` | èµ„æºä¸å­˜åœ¨   | è¯·æ±‚äº†ä¸å­˜åœ¨çš„èµ„æº         |
| `API_ERROR`          | API è°ƒç”¨å¤±è´¥ | LDIMS åç«¯ API ä¸å¯ç”¨      |
| `TIMEOUT`            | è¯·æ±‚è¶…æ—¶     | ç½‘ç»œå»¶è¿Ÿæˆ–æœåŠ¡å™¨å“åº”æ…¢     |
| `INTERNAL_ERROR`     | å†…éƒ¨é”™è¯¯     | æœåŠ¡å™¨å†…éƒ¨å¼‚å¸¸             |

---

**æœ€åæ›´æ–°**: 2024å¹´12æœˆ  
**API ç‰ˆæœ¬**: 1.0.0
